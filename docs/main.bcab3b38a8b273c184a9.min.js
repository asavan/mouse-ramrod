(()=>{"use strict";function e(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function t(t,n,o,s){const r=t.location.search,i=new URLSearchParams(r);for(const[t,n]of i)"number"==typeof o[t]?o[t]=parseInt(n,10):"boolean"==typeof o[t]?o[t]=e(n):o[t]=n;"serviceWorker"in navigator&&(navigator.serviceWorker.register("./sw.js",{scope:"./"}),function(e,t,n){const o=t.getElementById("butInstall");let s=null;o.addEventListener("click",(e=>{o.classList.add("hidden"),s.prompt(),s.userChoice.then((e=>{}))})),e.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),s=e,n&&n.install&&o.classList.remove("hidden")}))}(t,n,o));s(t,n,o).on("gameover",(e=>{n.getElementById("butInstall").classList.remove("hidden2")}))}function n(e,t){return e+" "+function(e,t){return t[e%100>4&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]}(e,t)}function o(e,t){let n=0,o=!1,s=-1,r=!1,i=!1;const c=t(e);return{isWin:()=>r,tryMoveToIndex:t=>{return!o&&((n=t)>=0&&n<e&&(s=t,o=!0,!0));var n},getMoveCount:()=>n,isRamrodPos:e=>e===s,isMousePos:e=>i&&c.isMousePos(e),setShowMousePos:e=>{i=e,o=!1,s=-1},mouseMove:()=>{o&&(++n,r=c.hit(s),i=!0)}}}function s(e){let t=[],n=[];for(let n=0;n<e;++n)t.push(n);const o=(t,n)=>{var o;(o=n)>=0&&o<e&&(t.includes(n)||t.push(n))};return{hit:e=>{const s=t.filter((t=>t!==e)),r=[];for(const e of s)o(r,e-1),o(r,e+1);return n=t,t=r,0===t.length},getPositions:()=>t,isMousePos:e=>n.includes(e)}}function r(e){const t=t=>t>=0&&t<e;let n=Math.floor((e-1)/2),o=[];const s=(e,n)=>{t(n)&&e.push(n)};s(o,n),s(o,n+1);const r=n=>t(n)?(t=>0===t||t===e-1)(n)?1:2:0,i=()=>n;return{getPrevPos:i,hit:function(e){const t=o.filter((t=>t!==e));let i=0,c=-1;for(const e of t){const t=r(e-1)+r(e+1);i<t&&(i=t,c=e)}return o=[],0===i?(n=e,!0):(n=c,s(o,n+1),s(o,n-1),!1)},isWin:()=>0===o.length,isMousePos:e=>e===i()}}function i(e){return Math.floor(Math.random()*e)}function c(e){let t=i(e),n=-1;const o=[-1,1];return{getPos:()=>t,hit:function(s){if(n=t,s===t)return!0;const r=[];for(const n of o){const o=t+n;(c=o)>=0&&c<e&&r.push(o)}var c,u;return 0===r.length||(t=(u=r)[i(u.length)],!1)},isMousePos:e=>e===n}}function u(){}!function(e,n,o,s){!function(e,t,n,o,s){"loading"!==n.readyState?e(t,n,o,s):n.addEventListener("DOMContentLoaded",(function(r){e(t,n,o,s)}))}(t,e,n,o,s)}(window,document,{mouse:0,ramrod:1,collision:1,size:5,sound:!1,install:!0},(function(e,t,i){const l=t.querySelector(".box"),a=t.querySelector(".message"),f=t.querySelector(".overlay"),d=t.querySelector(".close"),m=t.getElementById("tada");t.documentElement.style.setProperty("--field-size",i.size);const v={gameover:u,mouse:u,ramrod:u},h=[s,r,r,c,r,s,c,r],g=o(i.size,h[i.mouse]);function M(){var e;f.querySelector(".content").textContent="За  "+n(g.getMoveCount(),["ход","хода","ходов"]),f.classList.add("show"),v.gameover(g.getMoveCount()),i.sound&&(e=m)&&e.play()}function p(){!function(e,t,o,s){const r=["","&#128045;","&#128001;","&#128431;","&#128432;","&#128433;","&#128433;&#65039;","&#128511;"],i=["&#128371;","&#128296;","&#129683;","&#9935;","&#128481;","&#128298;","&#128295;","&#128204;","&#129696;","&#129668;"],c=["&#129700;","&#128165;","&#127878;","&#9904;&#65039;"];function u(e,t){e.innerHTML=t?`<span>${t}</span>`:""}for(let n=0;n<s.size;n++){const o=t.childNodes[n];e.isRamrodPos(n)?e.isWin()?u(o,c[s.collision]):u(o,i[s.ramrod]):e.isMousePos(n)?u(o,r[s.mouse]):u(o,"")}o&&e.getMoveCount()&&(o.textContent=n(e.getMoveCount(),["ход","хода","ходов"]))}(g,l,a,i),g.isWin()&&setTimeout(M,200)}return function(e,t,n,o){for(let s=0;s<e;s++){const e=o.createElement("div");e.className=t,n.appendChild(e)}}(i.size,"cell",l,t),p(),l.addEventListener("click",(function(e){const t=function(e,t){return e.preventDefault(),e.target.classList.contains("cell")?function(e,t){for(let n=0;n<t.children.length;n++)if(t.children[n]===e.target)return n;return-1}(e,t):-1}(e,l);g.tryMoveToIndex(t)&&setTimeout((function(){g.mouseMove(),p(),g.isWin()||setTimeout((()=>{g.setShowMousePos(!1),p()}),200)}),60)}),!1),d.addEventListener("click",(function(e){e.preventDefault(),f.classList.remove("show")}),!1),{on:function(e,t){v[e]=t}}}))})();