(()=>{"use strict";function e(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function t(t,n,o,s){const r=t.location.search,i=new URLSearchParams(r);for(const[t,n]of i)"number"==typeof o[t]?o[t]=parseInt(n,10):"boolean"==typeof o[t]?o[t]=e(n):o[t]=n;"serviceWorker"in navigator&&(navigator.serviceWorker.register("./sw.js",{scope:"./"}),function(e,t,n){const o=t.getElementById("butInstall");let s;o.addEventListener("click",(e=>{o.classList.add("hidden"),s.prompt(),s.userChoice.then((e=>{}))})),e.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),s=e,n&&n.showInstall&&o.classList.remove("hidden")}))}(t,n,o)),s(t,n,o)}function n(e,t){return e+" "+function(e,t){return t[e%100>4&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]}(e,t)}function o(e){let t=[];for(let n=0;n<e;++n)t.push(n);let n=[];const o=(t,n)=>{var o;(o=n)>=0&&o<e&&(t.includes(n)||t.push(n))};return{hit:e=>{n.push(e);const s=t.filter((t=>t!==e)),r=[];for(const e of s)o(r,e-1),o(r,e+1);return t=r,0===t.length},getPositions:()=>t}}function s(e){const t=t=>t>=0&&t<e;let n=e-1,o=[Math.floor((e-1)/2),Math.floor((e-1)/2)+1];const s=(e,n)=>{t(n)&&e.push(n)},r=n=>t(n)?(t=>0===t||t===e)(n)?1:2:0;return{getPrevPos:()=>n,hit:function(e){const i=o.filter((n=>n!==e&&t(n)));let c=0,u=-1;for(const e of i){const t=r(e-1)+r(e+1);c<t&&(c=t,u=e)}return o=[],0===c||(n=u,s(o,n+1),s(o,n-1),!1)},isWin:()=>0===o.length}}function r(e,t){let n=0,r=!1,i=-1,c=!1,u=!1;const a=s(e),l=o(e);return{size:e,isWin:()=>c,tryMoveToIndex:t=>{return!r&&((n=t)>=0&&n<e&&(i=t,r=!0,!0));var n},getMoveCount:()=>n,isRamrodPos:e=>e===i,isMousePos:e=>!c&&u&&e===a.getPrevPos(),setShowMousePos:e=>{u=e,r=!1,i=-1},mouseMove:()=>{r&&(++n,t?c=l.hit(i):(c=a.hit(i),u=!0))}}}function i(){}!function(e,n,o,s){!function(e,t,n,o,s){"loading"!==n.readyState?e(t,n,o,s):n.addEventListener("DOMContentLoaded",(function(r){e(t,n,o,s)}))}(t,e,n,o,s)}(window,document,{mouse:0,size:5,sound:!1},(function(e,t,o){const s=t.querySelector(".box"),c=t.querySelector(".message"),u=t.querySelector(".overlay"),a=t.querySelector(".close"),l=t.getElementById("tada");t.documentElement.style.setProperty("--field-size",o.size);const f={gameover:i},d=r(o.size,0===o.mouse);function v(){var e;!function(e,t,o,s){const r=["&#128045;","&#128001;","&#128431;","&#128432;","&#128433;"];for(let n=0;n<e.size;n++){const o=t.childNodes[n];if(o.className="cell",e.isRamrodPos(n))e.isWin()?o.innerHTML="<span>&#128165;</span>":o.innerHTML="<span>&#128296;</span>";else if(e.isMousePos(n)){if(s.mouse){const e=r[s.mouse-1];e&&(o.innerHTML=`<span>${e}</span>`)}}else o.innerHTML=""}o&&e.getMoveCount()&&(o.textContent=n(e.getMoveCount(),["ход","хода","ходов"]))}(d,s,c,o),d.isWin()&&(u.querySelector(".content").textContent="За  "+n(d.getMoveCount(),["ход","хода","ходов"]),u.classList.add("show"),f.gameover(d.getMoveCount()),o.sound&&(e=l)&&e.play())}return function(e,t,n,o){for(let s=0;s<e;s++){const e=o.createElement("div");e.className=t,n.appendChild(e)}}(d.size,"cell",s,t),v(),s.addEventListener("click",(function(e){const t=function(e,t){if(e.preventDefault(),e.target.classList.contains("cell")||e.target.classList.contains("digit"))return function(e,t){const n=e.target||e.srcElement;for(let e=0;e<t.children.length;e++)if(t.children[e]===n)return e;return-1}(e,t)}(e,s);d.tryMoveToIndex(t)&&(v(),d.isWin()||setTimeout((function(){d.mouseMove(),v(),d.isWin()||setTimeout((()=>{d.setShowMousePos(!1),v()}),200)}),200))}),!1),a.addEventListener("click",(function(e){e.preventDefault(),u.classList.remove("show")}),!1),{on:function(e,t){f[e]=t}}}))})();